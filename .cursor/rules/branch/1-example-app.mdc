---
description: 1-example-appブランチでの開発時に読み込む
alwaysApply: false
---
example配下フロントエンド新規 + Rabby接続 + レジ/QR/入金監視
===

このブランチで実装することは以下の通りです。
- `example/` 配下にフロントエンドの新規プロジェクトを作成する（プロジェクト名/構成は要確定）
- 接続先チェーンは `sepolia` と `anvil`（ローカル）を対象にする
- wallet 接続には `@rainbow-me/rainbowkit` を使う（必要に応じて wagmi/viem を併用）
- 対象通貨は ERC-20 とする（ネイティブ通貨はスコープ外）
- レジ機能：金額入力 → `wallet address` と `amount`（+ `token`）から送金/入金のためのQRコードを表示する
- 受取用アドレスは RainbowKit で接続したアドレスを使う
- 入金検知は行わず、一定間隔（10秒）で `balanceOf` を `setTimeout` で更新し、画面表示を更新する

このブランチでやらないこと（スコープ外）
- バックエンド/スマートコントラクトの実装変更（必要なら別ブランチ/別PRで扱う）
- 本番運用のための監視/アラート/決済完了通知の高度化（まずは動作確認優先）
- マルチチェーン・マルチトークンの完全対応（最初は1チェーン/1通貨に絞る前提で設計）

## 進捗
- [ ] 要件確定：対象チェーンは `sepolia` / `anvil`、対象通貨は ERC-20、対象トークン（コントラクトアドレス/decimals/symbol）とQRの形式（EIP-681等）を決める
- [x] `example/` 配下に新規フロントエンド雛形を追加（README/起動手順含む）
- [x] 環境変数 `VITE_JPYC_ADRESS` を追加（`viem` の `Address` 型で扱う）
- [x] `JPYC` ERC-20コントラクト + デプロイスクリプトを追加（`solidity/src/JPYC.sol`, `solidity/script/JPYC/deploy.*`）
- [ ] `@rainbow-me/rainbowkit` でウォレット接続（接続/切断、未接続時UI、チェーン切替：sepolia/anvil）
- [ ] レジUI（金額入力、バリデーション、小数/桁、通貨表示）
- [x] RegisterPanel：入力項目を金額のみに整理
- [ ] QR生成（`address` + `amount` + `token` → QR表示、コピーボタン、深いリンク形式の整理）
- [ ] 10秒更新の `balanceOf` 取得を実装（`setTimeout` でループ、画面更新、ローディング/エラー）
- [ ] 最低限のUX（入金待ち/検知/完了、手動更新、最終更新時刻）
- [ ] 最低限のUX（残高表示、手動更新、最終更新時刻）
- [ ] 動作確認（RainbowKitでの接続、テスト送金、`balanceOf` 更新）

## 参考資料
- `@rainbow-me/rainbowkit` / wagmi / viem
- EIP-1193：`window.ethereum`
- QR：EIP-681（`ethereum:` URI）/ ERC-20送金URI（採用するなら仕様リンクを後で追記）
- ERC-20：`transfer` / `Transfer(address,address,uint256)` イベント

## 調査結果・設計まとめ
- 受取用アドレスは RainbowKit で接続したアドレスを使う（端末依存になるため、将来的に店舗固定アドレス方式にするかは別途検討）
- 入金検知は行わず、画面表示は `balanceOf` の定期更新（10秒）で追従する
- `sepolia` と `anvil` で同一のUXになるよう、チェーンごとのトークンアドレス解決（設定ファイル/環境変数/画面選択）を用意する（現状は `VITE_JPYC_ADRESS` で注入）
- QRは「ユーザーのウォレットが解釈できる形式」を優先し、アプリ内表現（`address`+`amount`）とURI表現を分離して設計する
- 10秒ポーリングは、画面が非表示の時の停止、最新結果のキャンセル、失敗時のリトライ方針を決める
- 禁止事項：このリポジトリでは `git add` / `git commit` は実行しない
